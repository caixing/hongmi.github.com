---
layout: post
title: 调整ext文件系统分区大小
category : linux
tags : [linux, gentoo, resize2fs, fdisk]
---
{% include JB/setup %}

今天中午编译mongodb的过程中，提示磁盘空间不足。使用df命令看了一下，总共拥有8G多多根分区大小，已经使用告罄。然而我的系统是在VirtualBox虚拟机上，磁盘分配了20G的固态大小存储，却只有8G之多？这让我很纳闷过了一会我终于想起来这8G是第一次创建虚拟机时初始化的，当时默认是8G。但后来发现8G有点小，于是就使用virtualbox的磁盘扩容命令将磁盘容量扩充到20G，这也让我原本就容量不宽裕的笔记本硬盘更加吃紧。原以为扩容之后，linux会自动将分区调整到20G大小，现在想来真是异想天开。系统都是使用分区表规定分区的起始和结束位置，分区表不变，哪里会自动扩容呢？  
到网上Google一番，发现了如下方法可以在不影响原来分区内容的情况下扩展分区。  
首先，使用fdisk工具查看并记录要扩容的分区的开始位置。  
fdisk -l /dev/sda   
第二，使用fdisk /dev/sda删除要扩容的分区，然后新建新分区，指定分区起始处和删除前一样！当然结束处调整为你期望的地方，我这里使用的是整个磁盘的最大区块地址。  
第三， 使用w命令将改动写入分区表并退出fdisk（我的系统提示我分区表重启之后才有效，因此这一步之后是重启），重启     
最后, 使用resize2fs /dev/sda2调整文件系统使其使用更大的分区。该命令根据分区表调整文件系统分区大小。  
这种事情当然不能有丝毫差错，否则系统恐怕就不能重新进入。特别是不能执行格式化！所以，在进行操作前，最好进行备份。